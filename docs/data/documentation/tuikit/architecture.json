{"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/Architecture"},"sections":[],"kind":"article","hierarchy":{"paths":[["doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit"]]},"schemaVersion":{"major":0,"patch":0,"minor":3},"metadata":{"role":"article","title":"Architecture Overview","roleHeading":"Article"},"abstract":[{"type":"text","text":"Understand the architecture and design patterns that power TUIKit."}],"primaryContentSections":[{"content":[{"type":"heading","level":2,"text":"Core Design Principles","anchor":"Core-Design-Principles"},{"inlineContent":[{"type":"text","text":"TUIKit follows these key principles:"}],"type":"paragraph"},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Declarative UI"}],"type":"strong"},{"text":": Describe what you want, not how to build it","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Composability","type":"text"}]},{"text":": Build complex UIs from simple, reusable components","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Value Semantics","type":"text"}]},{"text":": Views are lightweight value types, not stateful objects","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Data Flow","type":"text"}],"type":"strong"},{"text":": Clear, unidirectional data flow through Environment and State","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Pure Swift"}]},{"text":": No external dependencies or C bindings","type":"text"}],"type":"paragraph"}]}]},{"type":"heading","level":2,"text":"The View System","anchor":"The-View-System"},{"type":"heading","level":3,"text":"View Protocol","anchor":"View-Protocol"},{"inlineContent":[{"text":"The ","type":"text"},{"code":"View","type":"codeVoice"},{"text":" protocol is the foundation of TUIKit:","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["public protocol View {","    associatedtype Body: View","    @ViewBuilder var body: Body { get }","}"],"syntax":"swift"},{"inlineContent":[{"type":"text","text":"Views are "},{"type":"strong","inlineContent":[{"type":"text","text":"not"}]},{"type":"text","text":" UI elements—they’re descriptions of UI that get rendered when needed. This enables:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Lightweight composition"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Efficient updates","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Declarative syntax","type":"text"}]}]}]},{"type":"heading","level":3,"text":"Primitive vs Composite Views","anchor":"Primitive-vs-Composite-Views"},{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Primitive Views","type":"text"}]},{"type":"text","text":" directly render content:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Conform to "},{"type":"codeVoice","code":"Renderable"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Have "},{"type":"codeVoice","code":"body: Never"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Examples: ","type":"text"},{"code":"Text","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Button","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Menu","type":"codeVoice"}]}]}]},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Composite Views"}]},{"type":"text","text":" combine other views:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Define a ","type":"text"},{"type":"codeVoice","code":"body"},{"text":" property","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Renderer walks the tree recursively"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Examples: "},{"type":"codeVoice","code":"VStack"},{"type":"text","text":", "},{"type":"codeVoice","code":"HStack"},{"type":"text","text":", "},{"type":"codeVoice","code":"Card"}]}]}]},{"type":"heading","level":3,"text":"Rendering Pipeline","anchor":"Rendering-Pipeline"},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"inlineContent":[{"text":"View Tree","type":"text"}],"type":"strong"},{"text":": User creates view hierarchy","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Traversal","type":"text"}]},{"type":"text","text":": Renderer walks tree depth-first"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Rendering"}],"type":"strong"},{"text":": Primitive views produce ","type":"text"},{"type":"codeVoice","code":"FrameBuffer"},{"text":" character data","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Compositing"}]},{"text":": Overlays blend on top with character-level precision","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Output","type":"text"}]},{"text":": Terminal renders the final buffer","type":"text"}],"type":"paragraph"}]}]},{"type":"heading","level":2,"text":"State Management Architecture","anchor":"State-Management-Architecture"},{"type":"heading","level":3,"text":"Local State (@State)","anchor":"Local-State-State"},{"inlineContent":[{"type":"text","text":"Stored in the view itself:"}],"type":"paragraph"},{"type":"codeListing","code":["@State var count: Int = 0"],"syntax":"swift"},{"inlineContent":[{"text":"When ","type":"text"},{"code":"@State","type":"codeVoice"},{"text":" changes, the view re-renders automatically.","type":"text"}],"type":"paragraph"},{"type":"heading","level":3,"text":"Environment (Top-Down)","anchor":"Environment-Top-Down"},{"inlineContent":[{"text":"Parent views pass data to children:","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["@Environment(\\.theme) var theme","","\/\/ Theme flows from App → all children"],"syntax":"swift"},{"type":"heading","level":3,"text":"Preferences (Bottom-Up)","anchor":"Preferences-Bottom-Up"},{"inlineContent":[{"text":"Children can propagate values to parents (rarely used in TUIKit).","type":"text"}],"type":"paragraph"},{"type":"heading","level":3,"text":"Storage (@AppStorage, @SceneStorage)","anchor":"Storage-AppStorage-SceneStorage"},{"inlineContent":[{"text":"Persistent storage via:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"@AppStorage"}]},{"type":"text","text":": UserDefaults (macOS) or JSON file (Linux)"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"@SceneStorage"}]},{"type":"text","text":": Per-scene state restoration"}]}]}]},{"type":"heading","level":2,"text":"Data Flow Pattern","anchor":"Data-Flow-Pattern"},{"type":"codeListing","code":["┌─────────────────────────────────────┐","│           App or Scene              │","│  @AppStorage, @State, Environment   │","└────────┬────────────────────────────┘","         │ passes theme, data","         ▼","┌─────────────────────────────────────┐","│    Composite Views (VStack, etc)    │","│  pass Environment to children       │","└────────┬────────────────────────────┘","         │ may use @State locally","         ▼","┌─────────────────────────────────────┐","│     Primitive Views (Text, Button)  │","│  render to FrameBuffer              │","└─────────────────────────────────────┘"],"syntax":null},{"type":"heading","level":2,"text":"Theme and Appearance System","anchor":"Theme-and-Appearance-System"},{"type":"heading","level":3,"text":"Theme Protocol","anchor":"Theme-Protocol"},{"inlineContent":[{"text":"Defines semantic colors:","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["public protocol Theme {","    var background: Color { get }","    var accent: Color { get }","    \/\/ ... other colors","}"],"syntax":"swift"},{"type":"heading","level":3,"text":"Appearance Protocol","anchor":"Appearance-Protocol"},{"inlineContent":[{"text":"Defines structural styles:","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["public enum Appearance {","    case line, rounded, doubleLine, heavy, block","}"],"syntax":"swift"},{"inlineContent":[{"text":"Both are passed through Environment, enabling:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Global theme switching","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Dynamic appearance changes","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"Consistent styling across app","type":"text"}],"type":"paragraph"}]}]},{"type":"heading","level":2,"text":"Focus Management System","anchor":"Focus-Management-System"},{"inlineContent":[{"code":"FocusManager","type":"codeVoice"},{"text":" tracks which element has keyboard focus:","type":"text"}],"type":"paragraph"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Focus ID"}],"type":"strong"},{"type":"text","text":": Each interactive element has a unique ID"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Navigation"}]},{"type":"text","text":": Tab\/Shift+Tab moves focus"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Rendering","type":"text"}]},{"type":"text","text":": Focused element shows visual indicator"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Events"}],"type":"strong"},{"text":": Keyboard events route to focused element","type":"text"}]}]}]},{"type":"codeListing","code":["@Environment(\\.focusManager) var focusManager","","\/\/ Navigation automatically updates focusManager","\/\/ onKeyPress receives keyboard events"],"syntax":"swift"},{"type":"heading","level":2,"text":"Modifier System","anchor":"Modifier-System"},{"inlineContent":[{"type":"text","text":"Modifiers wrap views to add behavior:"}],"type":"paragraph"},{"type":"codeListing","code":["extension View {","    func padding(_ amount: Int) -> some View {","        ModifiedView(content: self, modifier: PaddingModifier(amount))","    }","}"],"syntax":"swift"},{"inlineContent":[{"text":"Modifiers compose:","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["Text(\"Hello\")","    .bold()           \/\/ Text → BoldView","    .padding(1)       \/\/ BoldView → PaddedView","    .border(.rounded) \/\/ PaddedView → BorderedView"],"syntax":"swift"},{"type":"heading","level":2,"text":"Component Library","anchor":"Component-Library"},{"type":"heading","level":3,"text":"Container Views","anchor":"Container-Views"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"VStack","type":"codeVoice"},{"type":"text","text":", "},{"code":"HStack","type":"codeVoice"},{"type":"text","text":", "},{"code":"ZStack","type":"codeVoice"},{"type":"text","text":": Layout primitives"}]}]},{"content":[{"inlineContent":[{"code":"Card","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Box","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Panel","type":"codeVoice"},{"text":": Styled containers","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"ContainerView"},{"type":"text","text":": Header\/body\/footer structure"}]}]}]},{"type":"heading","level":3,"text":"Interactive Views","anchor":"Interactive-Views"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"Button"},{"text":": Clickable button with focus","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Menu"},{"type":"text","text":": Selection menu with keyboard"}]}]},{"content":[{"inlineContent":[{"code":"Alert","type":"codeVoice"},{"type":"text","text":", "},{"code":"Dialog","type":"codeVoice"},{"type":"text","text":": Modal overlays"}],"type":"paragraph"}]}]},{"type":"heading","level":3,"text":"Structural Views","anchor":"Structural-Views"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"ForEach"},{"type":"text","text":": Render collections"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"Text"},{"type":"text","text":": Display text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"code":"Spacer","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Divider","type":"codeVoice"},{"text":": Layout helpers","type":"text"}],"type":"paragraph"}]}]},{"type":"heading","level":3,"text":"Status Bar","anchor":"Status-Bar"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"code":"StatusBar","type":"codeVoice"},{"text":": Application status bar","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"StatusBarItem"},{"text":": Individual item","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Shortcut"},{"type":"text","text":": Keyboard shortcut display"}]}]}]},{"type":"heading","level":2,"text":"Rendering Engine","anchor":"Rendering-Engine"},{"type":"heading","level":3,"text":"FrameBuffer","anchor":"FrameBuffer"},{"inlineContent":[{"text":"Character-level buffer for compositing:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"2D array of characters and attributes","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Supports color, styling (bold, italic, etc.)"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Compositing for overlays"}]}]}]},{"type":"heading","level":3,"text":"ANSI Renderer","anchor":"ANSI-Renderer"},{"inlineContent":[{"text":"Converts buffer to ANSI escape codes:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Color codes (foreground\/background)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Styling (bold, italic, underline)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Terminal state management"}]}]}]},{"type":"heading","level":3,"text":"Terminal Abstraction","anchor":"Terminal-Abstraction"},{"inlineContent":[{"type":"text","text":"Platform-specific terminal handling:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"macOS: termios"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Linux: termios via libc"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Raw mode, alternate screen, signal handling"}],"type":"paragraph"}]}]},{"type":"heading","level":2,"text":"Performance Considerations","anchor":"Performance-Considerations"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Lazy Rendering","type":"text"}]},{"type":"text","text":": Only visible areas render"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Diff Optimization","type":"text"}],"type":"strong"},{"type":"text","text":": Only changed areas redraw"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Buffer Reuse","type":"text"}],"type":"strong"},{"text":": FrameBuffer recycled across frames","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"View Value Semantics","type":"text"}],"type":"strong"},{"type":"text","text":": Lightweight copying and discarding"}]}]}]},{"type":"heading","level":2,"text":"Error Handling","anchor":"Error-Handling"},{"inlineContent":[{"type":"text","text":"TUIKit uses Swift’s error handling:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Fatal errors for programmer mistakes","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Non-fatal errors for recovery scenarios"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Storage backend errors are silenced (fallback to defaults)"}]}]}]},{"type":"heading","level":2,"text":"Platform Support","anchor":"Platform-Support"},{"type":"heading","level":3,"text":"macOS","anchor":"macOS"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Native UserDefaults for @AppStorage","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Full terminal support"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Modern Swift runtime"}],"type":"paragraph"}]}]},{"type":"heading","level":3,"text":"Linux","anchor":"Linux"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"JSON file storage for @AppStorage"}]}]},{"content":[{"inlineContent":[{"text":"glibc-based terminal support","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"XDG paths for configuration"}]}]}]},{"type":"heading","level":2,"text":"Future Extensibility","anchor":"Future-Extensibility"},{"inlineContent":[{"text":"The architecture supports:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Custom storage backends","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Custom themes"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Custom appearances","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Custom view components","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"Animation system (planned)","type":"text"}],"type":"paragraph"}]}]},{"type":"heading","level":2,"text":"Related Topics","anchor":"Related-Topics"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"View"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Theme"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Appearance"}]}]},{"content":[{"inlineContent":[{"code":"FocusManager","type":"codeVoice"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"code":"FrameBuffer","type":"codeVoice"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"doc:Rendering","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/StateManagement","type":"reference","isActive":true}]}]}]}],"kind":"content"}],"references":{"doc://com.anthropic.tuikit.documentation/documentation/TUIKit/StateManagement":{"url":"\/documentation\/tuikit\/statemanagement","kind":"article","title":"State Management","type":"topic","identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/StateManagement","abstract":[{"text":"Learn how to manage application state and data flow in TUIKit.","type":"text"}],"role":"article"},"doc://com.anthropic.tuikit.documentation/documentation/TUIKit":{"url":"\/documentation\/tuikit","abstract":[],"identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit","title":"TUIKit","kind":"article","role":"collection","type":"topic"}}}