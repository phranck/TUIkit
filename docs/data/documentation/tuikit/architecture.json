{"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/Architecture"},"kind":"article","schemaVersion":{"major":0,"minor":3,"patch":0},"primaryContentSections":[{"kind":"content","content":[{"level":2,"type":"heading","anchor":"Core-Design-Principles","text":"Core Design Principles"},{"type":"paragraph","inlineContent":[{"type":"text","text":"TUIKit follows these key principles:"}]},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Declarative UI"}],"type":"strong"},{"type":"text","text":": Describe what you want, not how to build it"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Composability"}],"type":"strong"},{"text":": Build complex UIs from simple, reusable components","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Value Semantics"}]},{"text":": Views are lightweight value types, not stateful objects","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Data Flow"}]},{"type":"text","text":": Clear, unidirectional data flow through Environment and State"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Pure Swift","type":"text"}]},{"text":": No external dependencies or C bindings","type":"text"}],"type":"paragraph"}]}]},{"level":2,"type":"heading","anchor":"The-View-System","text":"The View System"},{"level":3,"type":"heading","anchor":"View-Protocol","text":"View Protocol"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"code":"View","type":"codeVoice"},{"type":"text","text":" protocol is the foundation of TUIKit:"}]},{"type":"codeListing","syntax":"swift","code":["public protocol View {","    associatedtype Body: View","    @ViewBuilder var body: Body { get }","}"]},{"type":"paragraph","inlineContent":[{"text":"Views are ","type":"text"},{"inlineContent":[{"text":"not","type":"text"}],"type":"strong"},{"text":" UI elements—they’re descriptions of UI that get rendered when needed. This enables:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Lightweight composition"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Efficient updates","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Declarative syntax","type":"text"}]}]}]},{"level":3,"type":"heading","anchor":"Primitive-vs-Composite-Views","text":"Primitive vs Composite Views"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Primitive Views"}],"type":"strong"},{"text":" directly render content:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Conform to ","type":"text"},{"code":"Renderable","type":"codeVoice"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Have "},{"type":"codeVoice","code":"body: Never"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Examples: "},{"code":"Text","type":"codeVoice"},{"type":"text","text":", "},{"code":"Button","type":"codeVoice"},{"type":"text","text":", "},{"code":"Menu","type":"codeVoice"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Composite Views"}]},{"type":"text","text":" combine other views:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Define a ","type":"text"},{"code":"body","type":"codeVoice"},{"text":" property","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Renderer walks the tree recursively"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Examples: "},{"type":"codeVoice","code":"VStack"},{"type":"text","text":", "},{"type":"codeVoice","code":"HStack"},{"type":"text","text":", "},{"type":"codeVoice","code":"Card"}],"type":"paragraph"}]}]},{"level":3,"type":"heading","anchor":"Rendering-Pipeline","text":"Rendering Pipeline"},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"View Tree","type":"text"}]},{"type":"text","text":": User creates view hierarchy"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Traversal"}],"type":"strong"},{"type":"text","text":": Renderer walks tree depth-first"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Rendering"}]},{"type":"text","text":": Primitive views produce "},{"type":"codeVoice","code":"FrameBuffer"},{"type":"text","text":" character data"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Compositing"}],"type":"strong"},{"text":": Overlays blend on top with character-level precision","type":"text"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Output"}],"type":"strong"},{"type":"text","text":": Terminal renders the final buffer"}],"type":"paragraph"}]}]},{"level":2,"type":"heading","anchor":"State-Management-Architecture","text":"State Management Architecture"},{"level":3,"type":"heading","anchor":"Local-State-State","text":"Local State (@State)"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Stored in the view itself:"}]},{"type":"codeListing","syntax":"swift","code":["@State var count: Int = 0"]},{"type":"paragraph","inlineContent":[{"text":"When ","type":"text"},{"code":"@State","type":"codeVoice"},{"text":" changes, the view re-renders automatically.","type":"text"}]},{"level":3,"type":"heading","anchor":"Environment-Top-Down","text":"Environment (Top-Down)"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Parent views pass data to children:"}]},{"type":"codeListing","syntax":"swift","code":["@Environment(\\.theme) var theme","","\/\/ Theme flows from App → all children"]},{"level":3,"type":"heading","anchor":"Preferences-Bottom-Up","text":"Preferences (Bottom-Up)"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Children can propagate values to parents (rarely used in TUIKit)."}]},{"level":3,"type":"heading","anchor":"Storage-AppStorage-SceneStorage","text":"Storage (@AppStorage, @SceneStorage)"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Persistent storage via:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"@AppStorage"}],"type":"strong"},{"text":": UserDefaults (macOS) or JSON file (Linux)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"@SceneStorage"}]},{"type":"text","text":": Per-scene state restoration"}]}]}]},{"level":2,"type":"heading","anchor":"Data-Flow-Pattern","text":"Data Flow Pattern"},{"type":"codeListing","syntax":null,"code":["┌─────────────────────────────────────┐","│           App or Scene              │","│  @AppStorage, @State, Environment   │","└────────┬────────────────────────────┘","         │ passes theme, data","         ▼","┌─────────────────────────────────────┐","│    Composite Views (VStack, etc)    │","│  pass Environment to children       │","└────────┬────────────────────────────┘","         │ may use @State locally","         ▼","┌─────────────────────────────────────┐","│     Primitive Views (Text, Button)  │","│  render to FrameBuffer              │","└─────────────────────────────────────┘"]},{"level":2,"type":"heading","anchor":"Theme-and-Appearance-System","text":"Theme and Appearance System"},{"level":3,"type":"heading","anchor":"Theme-Protocol","text":"Theme Protocol"},{"type":"paragraph","inlineContent":[{"text":"Defines semantic colors:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["public protocol Theme {","    var background: Color { get }","    var accent: Color { get }","    \/\/ ... other colors","}"]},{"level":3,"type":"heading","anchor":"Appearance-Protocol","text":"Appearance Protocol"},{"type":"paragraph","inlineContent":[{"text":"Defines structural styles:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["public enum Appearance {","    case line, rounded, doubleLine, heavy, block","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Both are passed through Environment, enabling:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Global theme switching"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Dynamic appearance changes"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Consistent styling across app"}]}]}]},{"level":2,"type":"heading","anchor":"Focus-Management-System","text":"Focus Management System"},{"type":"paragraph","inlineContent":[{"code":"FocusManager","type":"codeVoice"},{"text":" tracks which element has keyboard focus:","type":"text"}]},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Focus ID"}],"type":"strong"},{"type":"text","text":": Each interactive element has a unique ID"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Navigation","type":"text"}]},{"text":": Tab\/Shift+Tab moves focus","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Rendering"}],"type":"strong"},{"text":": Focused element shows visual indicator","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Events"}],"type":"strong"},{"type":"text","text":": Keyboard events route to focused element"}]}]}]},{"type":"codeListing","syntax":"swift","code":["@Environment(\\.focusManager) var focusManager","","\/\/ Navigation automatically updates focusManager","\/\/ onKeyPress receives keyboard events"]},{"level":2,"type":"heading","anchor":"Modifier-System","text":"Modifier System"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Modifiers wrap views to add behavior:"}]},{"type":"codeListing","syntax":"swift","code":["extension View {","    func padding(_ amount: Int) -> some View {","        ModifiedView(content: self, modifier: PaddingModifier(amount))","    }","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Modifiers compose:"}]},{"type":"codeListing","syntax":"swift","code":["Text(\"Hello\")","    .bold()           \/\/ Text → BoldView","    .padding(1)       \/\/ BoldView → PaddedView","    .border(.rounded) \/\/ PaddedView → BorderedView"]},{"level":2,"type":"heading","anchor":"Component-Library","text":"Component Library"},{"level":3,"type":"heading","anchor":"Container-Views","text":"Container Views"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"VStack"},{"type":"text","text":", "},{"type":"codeVoice","code":"HStack"},{"type":"text","text":", "},{"type":"codeVoice","code":"ZStack"},{"type":"text","text":": Layout primitives"}]}]},{"content":[{"inlineContent":[{"code":"Card","type":"codeVoice"},{"type":"text","text":", "},{"code":"Box","type":"codeVoice"},{"type":"text","text":", "},{"code":"Panel","type":"codeVoice"},{"type":"text","text":": Styled containers"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"code":"ContainerView","type":"codeVoice"},{"text":": Header\/body\/footer structure","type":"text"}],"type":"paragraph"}]}]},{"level":3,"type":"heading","anchor":"Interactive-Views","text":"Interactive Views"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"Button","type":"codeVoice"},{"type":"text","text":": Clickable button with focus"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"Menu"},{"type":"text","text":": Selection menu with keyboard"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Alert"},{"type":"text","text":", "},{"type":"codeVoice","code":"Dialog"},{"type":"text","text":": Modal overlays"}]}]}]},{"level":3,"type":"heading","anchor":"Structural-Views","text":"Structural Views"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"ForEach","type":"codeVoice"},{"text":": Render collections","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Text"},{"type":"text","text":": Display text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Spacer"},{"type":"text","text":", "},{"type":"codeVoice","code":"Divider"},{"type":"text","text":": Layout helpers"}]}]}]},{"level":3,"type":"heading","anchor":"Status-Bar","text":"Status Bar"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"code":"StatusBar","type":"codeVoice"},{"text":": Application status bar","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"StatusBarItem"},{"text":": Individual item","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Shortcut"},{"type":"text","text":": Keyboard shortcut display"}]}]}]},{"level":2,"type":"heading","anchor":"Rendering-Engine","text":"Rendering Engine"},{"level":3,"type":"heading","anchor":"FrameBuffer","text":"FrameBuffer"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Character-level buffer for compositing:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"2D array of characters and attributes"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Supports color, styling (bold, italic, etc.)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Compositing for overlays","type":"text"}]}]}]},{"level":3,"type":"heading","anchor":"ANSI-Renderer","text":"ANSI Renderer"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Converts buffer to ANSI escape codes:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Color codes (foreground\/background)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Styling (bold, italic, underline)"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Terminal state management"}],"type":"paragraph"}]}]},{"level":3,"type":"heading","anchor":"Terminal-Abstraction","text":"Terminal Abstraction"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Platform-specific terminal handling:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"macOS: termios","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Linux: termios via libc"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Raw mode, alternate screen, signal handling"}]}]}]},{"level":2,"type":"heading","anchor":"Performance-Considerations","text":"Performance Considerations"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Lazy Rendering"}],"type":"strong"},{"text":": Only visible areas render","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Diff Optimization"}]},{"type":"text","text":": Only changed areas redraw"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Buffer Reuse","type":"text"}]},{"type":"text","text":": FrameBuffer recycled across frames"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"View Value Semantics"}],"type":"strong"},{"text":": Lightweight copying and discarding","type":"text"}]}]}]},{"level":2,"type":"heading","anchor":"Error-Handling","text":"Error Handling"},{"type":"paragraph","inlineContent":[{"type":"text","text":"TUIKit uses Swift’s error handling:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Fatal errors for programmer mistakes","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Non-fatal errors for recovery scenarios"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Storage backend errors are silenced (fallback to defaults)"}]}]}]},{"level":2,"type":"heading","anchor":"Platform-Support","text":"Platform Support"},{"level":3,"type":"heading","anchor":"macOS","text":"macOS"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Native UserDefaults for @AppStorage"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Full terminal support","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Modern Swift runtime"}],"type":"paragraph"}]}]},{"level":3,"type":"heading","anchor":"Linux","text":"Linux"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"JSON file storage for @AppStorage","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"glibc-based terminal support"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"XDG paths for configuration","type":"text"}]}]}]},{"level":2,"type":"heading","anchor":"Future-Extensibility","text":"Future Extensibility"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The architecture supports:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Custom storage backends"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Custom themes"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Custom appearances"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Custom view components"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Animation system (planned)"}],"type":"paragraph"}]}]},{"level":2,"type":"heading","anchor":"Related-Topics","text":"Related Topics"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"View"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Theme"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"Appearance"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"FocusManager","type":"codeVoice"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"FrameBuffer"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"doc:Rendering"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"isActive":true,"type":"reference","identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/StateManagement"}],"type":"paragraph"}]}]}]}],"sections":[],"metadata":{"title":"Architecture Overview","roleHeading":"Article","role":"article"},"abstract":[{"type":"text","text":"Understand the architecture and design patterns that power TUIKit."}],"hierarchy":{"paths":[["doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit"]]},"references":{"doc://com.anthropic.tuikit.documentation/documentation/TUIKit":{"role":"collection","title":"TUIKit","kind":"article","identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit","abstract":[],"url":"\/documentation\/tuikit","type":"topic"},"doc://com.anthropic.tuikit.documentation/documentation/TUIKit/StateManagement":{"kind":"article","role":"article","abstract":[{"type":"text","text":"Learn how to manage application state and data flow in TUIKit."}],"title":"State Management","identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/StateManagement","url":"\/documentation\/tuikit\/statemanagement","type":"topic"}}}