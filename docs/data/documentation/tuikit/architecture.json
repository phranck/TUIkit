{"kind":"article","hierarchy":{"paths":[["doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit"]]},"sections":[],"identifier":{"url":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/Architecture","interfaceLanguage":"swift"},"schemaVersion":{"patch":0,"major":0,"minor":3},"abstract":[{"type":"text","text":"Understand the architecture and design patterns that power TUIKit."}],"primaryContentSections":[{"content":[{"level":2,"anchor":"Core-Design-Principles","type":"heading","text":"Core Design Principles"},{"inlineContent":[{"type":"text","text":"TUIKit follows these key principles:"}],"type":"paragraph"},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Declarative UI","type":"text"}]},{"type":"text","text":": Describe what you want, not how to build it"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Composability"}]},{"type":"text","text":": Build complex UIs from simple, reusable components"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Value Semantics"}],"type":"strong"},{"text":": Views are lightweight value types, not stateful objects","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Data Flow","type":"text"}]},{"type":"text","text":": Clear, unidirectional data flow through Environment and State"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Pure Swift","type":"text"}],"type":"strong"},{"text":": No external dependencies or C bindings","type":"text"}]}]}]},{"level":2,"anchor":"The-View-System","type":"heading","text":"The View System"},{"level":3,"anchor":"View-Protocol","type":"heading","text":"View Protocol"},{"inlineContent":[{"text":"The ","type":"text"},{"code":"View","type":"codeVoice"},{"text":" protocol is the foundation of TUIKit:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["public protocol View {","    associatedtype Body: View","    @ViewBuilder var body: Body { get }","}"]},{"inlineContent":[{"type":"text","text":"Views are "},{"type":"strong","inlineContent":[{"type":"text","text":"not"}]},{"type":"text","text":" UI elements—they’re descriptions of UI that get rendered when needed. This enables:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Lightweight composition"}]}]},{"content":[{"inlineContent":[{"text":"Efficient updates","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Declarative syntax"}],"type":"paragraph"}]}]},{"level":3,"anchor":"Primitive-vs-Composite-Views","type":"heading","text":"Primitive vs Composite Views"},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Primitive Views"}]},{"text":" directly render content:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Conform to ","type":"text"},{"type":"codeVoice","code":"Renderable"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Have "},{"code":"body: Never","type":"codeVoice"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Examples: "},{"type":"codeVoice","code":"Text"},{"type":"text","text":", "},{"type":"codeVoice","code":"Button"},{"type":"text","text":", "},{"type":"codeVoice","code":"Menu"}],"type":"paragraph"}]}]},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Composite Views"}],"type":"strong"},{"text":" combine other views:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Define a "},{"code":"body","type":"codeVoice"},{"type":"text","text":" property"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Renderer walks the tree recursively","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Examples: ","type":"text"},{"type":"codeVoice","code":"VStack"},{"text":", ","type":"text"},{"type":"codeVoice","code":"HStack"},{"text":", ","type":"text"},{"type":"codeVoice","code":"Card"}],"type":"paragraph"}]}]},{"level":3,"anchor":"Rendering-Pipeline","type":"heading","text":"Rendering Pipeline"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"View Tree","type":"text"}]},{"type":"text","text":": User creates view hierarchy"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Traversal"}]},{"type":"text","text":": Renderer walks tree depth-first"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Rendering","type":"text"}]},{"type":"text","text":": Primitive views produce "},{"code":"FrameBuffer","type":"codeVoice"},{"type":"text","text":" character data"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Compositing","type":"text"}]},{"type":"text","text":": Overlays blend on top with character-level precision"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Output"}],"type":"strong"},{"text":": Terminal renders the final buffer","type":"text"}],"type":"paragraph"}]}]},{"level":2,"anchor":"State-Management-Architecture","type":"heading","text":"State Management Architecture"},{"level":3,"anchor":"Local-State-State","type":"heading","text":"Local State (@State)"},{"inlineContent":[{"type":"text","text":"Stored in the view itself:"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["@State var count: Int = 0"]},{"inlineContent":[{"type":"text","text":"When "},{"type":"codeVoice","code":"@State"},{"type":"text","text":" changes, the view re-renders automatically."}],"type":"paragraph"},{"level":3,"anchor":"Environment-Top-Down","type":"heading","text":"Environment (Top-Down)"},{"inlineContent":[{"text":"Parent views pass data to children:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["@Environment(\\.theme) var theme","","\/\/ Theme flows from App → all children"]},{"level":3,"anchor":"Preferences-Bottom-Up","type":"heading","text":"Preferences (Bottom-Up)"},{"inlineContent":[{"text":"Children can propagate values to parents (rarely used in TUIKit).","type":"text"}],"type":"paragraph"},{"level":3,"anchor":"Storage-AppStorage-SceneStorage","type":"heading","text":"Storage (@AppStorage, @SceneStorage)"},{"inlineContent":[{"type":"text","text":"Persistent storage via:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"@AppStorage"}],"type":"strong"},{"type":"text","text":": UserDefaults (macOS) or JSON file (Linux)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"@SceneStorage"}]},{"type":"text","text":": Per-scene state restoration"}]}]}]},{"level":2,"anchor":"Data-Flow-Pattern","type":"heading","text":"Data Flow Pattern"},{"type":"codeListing","syntax":null,"code":["┌─────────────────────────────────────┐","│           App or Scene              │","│  @AppStorage, @State, Environment   │","└────────┬────────────────────────────┘","         │ passes theme, data","         ▼","┌─────────────────────────────────────┐","│    Composite Views (VStack, etc)    │","│  pass Environment to children       │","└────────┬────────────────────────────┘","         │ may use @State locally","         ▼","┌─────────────────────────────────────┐","│     Primitive Views (Text, Button)  │","│  render to FrameBuffer              │","└─────────────────────────────────────┘"]},{"level":2,"anchor":"Theme-and-Appearance-System","type":"heading","text":"Theme and Appearance System"},{"level":3,"anchor":"Theme-Protocol","type":"heading","text":"Theme Protocol"},{"inlineContent":[{"type":"text","text":"Defines semantic colors:"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["public protocol Theme {","    var background: Color { get }","    var accent: Color { get }","    \/\/ ... other colors","}"]},{"level":3,"anchor":"Appearance-Protocol","type":"heading","text":"Appearance Protocol"},{"inlineContent":[{"type":"text","text":"Defines structural styles:"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["public enum Appearance {","    case line, rounded, doubleLine, heavy, block","}"]},{"inlineContent":[{"type":"text","text":"Both are passed through Environment, enabling:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Global theme switching","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Dynamic appearance changes"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Consistent styling across app"}]}]}]},{"level":2,"anchor":"Focus-Management-System","type":"heading","text":"Focus Management System"},{"inlineContent":[{"code":"FocusManager","type":"codeVoice"},{"text":" tracks which element has keyboard focus:","type":"text"}],"type":"paragraph"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Focus ID","type":"text"}],"type":"strong"},{"text":": Each interactive element has a unique ID","type":"text"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Navigation"}],"type":"strong"},{"type":"text","text":": Tab\/Shift+Tab moves focus"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Rendering"}],"type":"strong"},{"text":": Focused element shows visual indicator","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Events","type":"text"}],"type":"strong"},{"text":": Keyboard events route to focused element","type":"text"}]}]}]},{"type":"codeListing","syntax":"swift","code":["@Environment(\\.focusManager) var focusManager","","\/\/ Navigation automatically updates focusManager","\/\/ onKeyPress receives keyboard events"]},{"level":2,"anchor":"Modifier-System","type":"heading","text":"Modifier System"},{"inlineContent":[{"type":"text","text":"Modifiers wrap views to add behavior:"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["extension View {","    func padding(_ amount: Int) -> some View {","        ModifiedView(content: self, modifier: PaddingModifier(amount))","    }","}"]},{"inlineContent":[{"text":"Modifiers compose:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["Text(\"Hello\")","    .bold()           \/\/ Text → BoldView","    .padding(1)       \/\/ BoldView → PaddedView","    .border(.rounded) \/\/ PaddedView → BorderedView"]},{"level":2,"anchor":"Component-Library","type":"heading","text":"Component Library"},{"level":3,"anchor":"Container-Views","type":"heading","text":"Container Views"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"VStack","type":"codeVoice"},{"text":", ","type":"text"},{"code":"HStack","type":"codeVoice"},{"text":", ","type":"text"},{"code":"ZStack","type":"codeVoice"},{"text":": Layout primitives","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"Card"},{"type":"text","text":", "},{"type":"codeVoice","code":"Box"},{"type":"text","text":", "},{"type":"codeVoice","code":"Panel"},{"type":"text","text":": Styled containers"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"ContainerView","type":"codeVoice"},{"text":": Header\/body\/footer structure","type":"text"}]}]}]},{"level":3,"anchor":"Interactive-Views","type":"heading","text":"Interactive Views"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"Button","type":"codeVoice"},{"text":": Clickable button with focus","type":"text"}]}]},{"content":[{"inlineContent":[{"code":"Menu","type":"codeVoice"},{"text":": Selection menu with keyboard","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"Alert","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Dialog","type":"codeVoice"},{"text":": Modal overlays","type":"text"}]}]}]},{"level":3,"anchor":"Structural-Views","type":"heading","text":"Structural Views"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"code":"ForEach","type":"codeVoice"},{"type":"text","text":": Render collections"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Text"},{"type":"text","text":": Display text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Spacer"},{"text":", ","type":"text"},{"type":"codeVoice","code":"Divider"},{"text":": Layout helpers","type":"text"}]}]}]},{"level":3,"anchor":"Status-Bar","type":"heading","text":"Status Bar"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"StatusBar"},{"type":"text","text":": Application status bar"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"StatusBarItem"},{"type":"text","text":": Individual item"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"Shortcut","type":"codeVoice"},{"text":": Keyboard shortcut display","type":"text"}]}]}]},{"level":2,"anchor":"Rendering-Engine","type":"heading","text":"Rendering Engine"},{"level":3,"anchor":"FrameBuffer","type":"heading","text":"FrameBuffer"},{"inlineContent":[{"text":"Character-level buffer for compositing:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"2D array of characters and attributes"}]}]},{"content":[{"inlineContent":[{"text":"Supports color, styling (bold, italic, etc.)","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Compositing for overlays"}],"type":"paragraph"}]}]},{"level":3,"anchor":"ANSI-Renderer","type":"heading","text":"ANSI Renderer"},{"inlineContent":[{"text":"Converts buffer to ANSI escape codes:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Color codes (foreground\/background)"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Styling (bold, italic, underline)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Terminal state management"}]}]}]},{"level":3,"anchor":"Terminal-Abstraction","type":"heading","text":"Terminal Abstraction"},{"inlineContent":[{"type":"text","text":"Platform-specific terminal handling:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"macOS: termios","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"Linux: termios via libc","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Raw mode, alternate screen, signal handling"}]}]}]},{"level":2,"anchor":"Performance-Considerations","type":"heading","text":"Performance Considerations"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Lazy Rendering"}]},{"type":"text","text":": Only visible areas render"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Diff Optimization"}],"type":"strong"},{"text":": Only changed areas redraw","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Buffer Reuse"}]},{"type":"text","text":": FrameBuffer recycled across frames"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"View Value Semantics","type":"text"}]},{"type":"text","text":": Lightweight copying and discarding"}],"type":"paragraph"}]}]},{"level":2,"anchor":"Error-Handling","type":"heading","text":"Error Handling"},{"inlineContent":[{"text":"TUIKit uses Swift’s error handling:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Fatal errors for programmer mistakes"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Non-fatal errors for recovery scenarios","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Storage backend errors are silenced (fallback to defaults)","type":"text"}],"type":"paragraph"}]}]},{"level":2,"anchor":"Platform-Support","type":"heading","text":"Platform Support"},{"level":3,"anchor":"macOS","type":"heading","text":"macOS"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Native UserDefaults for @AppStorage"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Full terminal support","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Modern Swift runtime","type":"text"}],"type":"paragraph"}]}]},{"level":3,"anchor":"Linux","type":"heading","text":"Linux"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"JSON file storage for @AppStorage"}]}]},{"content":[{"inlineContent":[{"text":"glibc-based terminal support","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"XDG paths for configuration","type":"text"}],"type":"paragraph"}]}]},{"level":2,"anchor":"Future-Extensibility","type":"heading","text":"Future Extensibility"},{"inlineContent":[{"type":"text","text":"The architecture supports:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Custom storage backends","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Custom themes"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Custom appearances"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Custom view components"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Animation system (planned)","type":"text"}],"type":"paragraph"}]}]},{"level":2,"anchor":"Related-Topics","type":"heading","text":"Related Topics"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"View","type":"codeVoice"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"Theme"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Appearance"}]}]},{"content":[{"inlineContent":[{"code":"FocusManager","type":"codeVoice"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"FrameBuffer"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"doc:Rendering"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/StateManagement","type":"reference","isActive":true}]}]}]}],"kind":"content"}],"metadata":{"title":"Architecture Overview","roleHeading":"Article","role":"article"},"references":{"doc://com.anthropic.tuikit.documentation/documentation/TUIKit":{"title":"TUIKit","role":"collection","type":"topic","abstract":[],"identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit","url":"\/documentation\/tuikit","kind":"article"},"doc://com.anthropic.tuikit.documentation/documentation/TUIKit/StateManagement":{"identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/StateManagement","role":"article","url":"\/documentation\/tuikit\/statemanagement","type":"topic","abstract":[{"text":"Learn how to manage application state and data flow in TUIKit.","type":"text"}],"kind":"article","title":"State Management"}}}