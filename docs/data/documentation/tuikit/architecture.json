{"schemaVersion":{"minor":3,"major":0,"patch":0},"kind":"article","hierarchy":{"paths":[["doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit"]]},"metadata":{"role":"article","roleHeading":"Article","title":"Architecture Overview"},"abstract":[{"text":"Understand the architecture and design patterns that power TUIKit.","type":"text"}],"sections":[],"primaryContentSections":[{"kind":"content","content":[{"level":2,"anchor":"Core-Design-Principles","text":"Core Design Principles","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"TUIKit follows these key principles:","type":"text"}]},{"items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Declarative UI"}],"type":"strong"},{"text":": Describe what you want, not how to build it","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Composability"}]},{"type":"text","text":": Build complex UIs from simple, reusable components"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Value Semantics"}],"type":"strong"},{"text":": Views are lightweight value types, not stateful objects","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Data Flow"}],"type":"strong"},{"text":": Clear, unidirectional data flow through Environment and State","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"text":"Pure Swift","type":"text"}],"type":"strong"},{"text":": No external dependencies or C bindings","type":"text"}],"type":"paragraph"}]}],"type":"orderedList"},{"level":2,"anchor":"The-View-System","text":"The View System","type":"heading"},{"level":3,"anchor":"View-Protocol","text":"View Protocol","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"The ","type":"text"},{"code":"View","type":"codeVoice"},{"text":" protocol is the foundation of TUIKit:","type":"text"}]},{"code":["public protocol View {","    associatedtype Body: View","    @ViewBuilder var body: Body { get }","}"],"syntax":"swift","type":"codeListing"},{"type":"paragraph","inlineContent":[{"text":"Views are ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"not"}]},{"text":" UI elements—they’re descriptions of UI that get rendered when needed. This enables:","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Lightweight composition","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Efficient updates"}]}]},{"content":[{"inlineContent":[{"text":"Declarative syntax","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":3,"anchor":"Primitive-vs-Composite-Views","text":"Primitive vs Composite Views","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Primitive Views","type":"text"}]},{"type":"text","text":" directly render content:"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Conform to "},{"type":"codeVoice","code":"Renderable"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Have ","type":"text"},{"code":"body: Never","type":"codeVoice"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Examples: "},{"type":"codeVoice","code":"Text"},{"type":"text","text":", "},{"type":"codeVoice","code":"Button"},{"type":"text","text":", "},{"type":"codeVoice","code":"Menu"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Composite Views"}],"type":"strong"},{"text":" combine other views:","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Define a ","type":"text"},{"type":"codeVoice","code":"body"},{"text":" property","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Renderer walks the tree recursively"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Examples: ","type":"text"},{"code":"VStack","type":"codeVoice"},{"text":", ","type":"text"},{"code":"HStack","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Card","type":"codeVoice"}]}]}],"type":"unorderedList"},{"level":3,"anchor":"Rendering-Pipeline","text":"Rendering Pipeline","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"View Tree"}],"type":"strong"},{"text":": User creates view hierarchy","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Traversal","type":"text"}]},{"type":"text","text":": Renderer walks tree depth-first"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"text":"Rendering","type":"text"}],"type":"strong"},{"text":": Primitive views produce ","type":"text"},{"code":"FrameBuffer","type":"codeVoice"},{"text":" character data","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Compositing"}]},{"type":"text","text":": Overlays blend on top with character-level precision"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Output"}],"type":"strong"},{"type":"text","text":": Terminal renders the final buffer"}],"type":"paragraph"}]}],"type":"orderedList"},{"level":2,"anchor":"State-Management-Architecture","text":"State Management Architecture","type":"heading"},{"level":3,"anchor":"Local-State-State","text":"Local State (@State)","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"Stored in the view itself:","type":"text"}]},{"code":["@State var count: Int = 0"],"syntax":"swift","type":"codeListing"},{"type":"paragraph","inlineContent":[{"text":"When ","type":"text"},{"code":"@State","type":"codeVoice"},{"text":" changes, the view re-renders automatically.","type":"text"}]},{"level":3,"anchor":"Environment-Top-Down","text":"Environment (Top-Down)","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Parent views pass data to children:"}]},{"code":["@Environment(\\.theme) var theme","","\/\/ Theme flows from App → all children"],"syntax":"swift","type":"codeListing"},{"level":3,"anchor":"Preferences-Bottom-Up","text":"Preferences (Bottom-Up)","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Children can propagate values to parents (rarely used in TUIKit)."}]},{"level":3,"anchor":"Storage-AppStorage-SceneStorage","text":"Storage (@AppStorage, @SceneStorage)","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"Persistent storage via:","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"@AppStorage","type":"text"}]},{"type":"text","text":": UserDefaults (macOS) or JSON file (Linux)"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"@SceneStorage","type":"text"}]},{"type":"text","text":": Per-scene state restoration"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":2,"anchor":"Data-Flow-Pattern","text":"Data Flow Pattern","type":"heading"},{"code":["┌─────────────────────────────────────┐","│           App or Scene              │","│  @AppStorage, @State, Environment   │","└────────┬────────────────────────────┘","         │ passes theme, data","         ▼","┌─────────────────────────────────────┐","│    Composite Views (VStack, etc)    │","│  pass Environment to children       │","└────────┬────────────────────────────┘","         │ may use @State locally","         ▼","┌─────────────────────────────────────┐","│     Primitive Views (Text, Button)  │","│  render to FrameBuffer              │","└─────────────────────────────────────┘"],"syntax":null,"type":"codeListing"},{"level":2,"anchor":"Theme-and-Appearance-System","text":"Theme and Appearance System","type":"heading"},{"level":3,"anchor":"Theme-Protocol","text":"Theme Protocol","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Defines semantic colors:"}]},{"code":["public protocol Theme {","    var background: Color { get }","    var accent: Color { get }","    \/\/ ... other colors","}"],"syntax":"swift","type":"codeListing"},{"level":3,"anchor":"Appearance-Protocol","text":"Appearance Protocol","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"Defines structural styles:","type":"text"}]},{"code":["public enum Appearance {","    case line, rounded, doubleLine, heavy, block","}"],"syntax":"swift","type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Both are passed through Environment, enabling:"}]},{"items":[{"content":[{"inlineContent":[{"text":"Global theme switching","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Dynamic appearance changes","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Consistent styling across app","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":2,"anchor":"Focus-Management-System","text":"Focus Management System","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"FocusManager"},{"type":"text","text":" tracks which element has keyboard focus:"}]},{"items":[{"content":[{"inlineContent":[{"inlineContent":[{"text":"Focus ID","type":"text"}],"type":"strong"},{"text":": Each interactive element has a unique ID","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Navigation","type":"text"}],"type":"strong"},{"text":": Tab\/Shift+Tab moves focus","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Rendering","type":"text"}],"type":"strong"},{"type":"text","text":": Focused element shows visual indicator"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Events"}]},{"type":"text","text":": Keyboard events route to focused element"}]}]}],"type":"orderedList"},{"code":["@Environment(\\.focusManager) var focusManager","","\/\/ Navigation automatically updates focusManager","\/\/ onKeyPress receives keyboard events"],"syntax":"swift","type":"codeListing"},{"level":2,"anchor":"Modifier-System","text":"Modifier System","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"Modifiers wrap views to add behavior:","type":"text"}]},{"code":["extension View {","    func padding(_ amount: Int) -> some View {","        ModifiedView(content: self, modifier: PaddingModifier(amount))","    }","}"],"syntax":"swift","type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Modifiers compose:"}]},{"code":["Text(\"Hello\")","    .bold()           \/\/ Text → BoldView","    .padding(1)       \/\/ BoldView → PaddedView","    .border(.rounded) \/\/ PaddedView → BorderedView"],"syntax":"swift","type":"codeListing"},{"level":2,"anchor":"Component-Library","text":"Component Library","type":"heading"},{"level":3,"anchor":"Container-Views","text":"Container Views","type":"heading"},{"items":[{"content":[{"inlineContent":[{"code":"VStack","type":"codeVoice"},{"text":", ","type":"text"},{"code":"HStack","type":"codeVoice"},{"text":", ","type":"text"},{"code":"ZStack","type":"codeVoice"},{"text":": Layout primitives","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"Card","type":"codeVoice"},{"type":"text","text":", "},{"code":"Box","type":"codeVoice"},{"type":"text","text":", "},{"code":"Panel","type":"codeVoice"},{"type":"text","text":": Styled containers"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"ContainerView","type":"codeVoice"},{"text":": Header\/body\/footer structure","type":"text"}]}]}],"type":"unorderedList"},{"level":3,"anchor":"Interactive-Views","text":"Interactive Views","type":"heading"},{"items":[{"content":[{"inlineContent":[{"code":"Button","type":"codeVoice"},{"type":"text","text":": Clickable button with focus"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"Menu"},{"type":"text","text":": Selection menu with keyboard"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"code":"Alert","type":"codeVoice"},{"type":"text","text":", "},{"code":"Dialog","type":"codeVoice"},{"type":"text","text":": Modal overlays"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":3,"anchor":"Structural-Views","text":"Structural Views","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"ForEach"},{"type":"text","text":": Render collections"}]}]},{"content":[{"inlineContent":[{"code":"Text","type":"codeVoice"},{"text":": Display text","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"code":"Spacer","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Divider","type":"codeVoice"},{"text":": Layout helpers","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":3,"anchor":"Status-Bar","text":"Status Bar","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"StatusBar"},{"text":": Application status bar","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"StatusBarItem"},{"type":"text","text":": Individual item"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"Shortcut"},{"type":"text","text":": Keyboard shortcut display"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":2,"anchor":"Rendering-Engine","text":"Rendering Engine","type":"heading"},{"level":3,"anchor":"FrameBuffer","text":"FrameBuffer","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Character-level buffer for compositing:"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"2D array of characters and attributes"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Supports color, styling (bold, italic, etc.)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Compositing for overlays"}]}]}],"type":"unorderedList"},{"level":3,"anchor":"ANSI-Renderer","text":"ANSI Renderer","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"Converts buffer to ANSI escape codes:","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Color codes (foreground\/background)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Styling (bold, italic, underline)","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Terminal state management"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":3,"anchor":"Terminal-Abstraction","text":"Terminal Abstraction","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Platform-specific terminal handling:"}]},{"items":[{"content":[{"inlineContent":[{"text":"macOS: termios","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Linux: termios via libc"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Raw mode, alternate screen, signal handling"}]}]}],"type":"unorderedList"},{"level":2,"anchor":"Performance-Considerations","text":"Performance Considerations","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Lazy Rendering","type":"text"}],"type":"strong"},{"text":": Only visible areas render","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Diff Optimization","type":"text"}]},{"text":": Only changed areas redraw","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Buffer Reuse"}]},{"text":": FrameBuffer recycled across frames","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"View Value Semantics","type":"text"}],"type":"strong"},{"text":": Lightweight copying and discarding","type":"text"}]}]}],"type":"orderedList"},{"level":2,"anchor":"Error-Handling","text":"Error Handling","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"TUIKit uses Swift’s error handling:"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Fatal errors for programmer mistakes"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Non-fatal errors for recovery scenarios"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Storage backend errors are silenced (fallback to defaults)","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":2,"anchor":"Platform-Support","text":"Platform Support","type":"heading"},{"level":3,"anchor":"macOS","text":"macOS","type":"heading"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Native UserDefaults for @AppStorage"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Full terminal support"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Modern Swift runtime"}]}]}],"type":"unorderedList"},{"level":3,"anchor":"Linux","text":"Linux","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"JSON file storage for @AppStorage"}]}]},{"content":[{"inlineContent":[{"text":"glibc-based terminal support","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"XDG paths for configuration"}]}]}],"type":"unorderedList"},{"level":2,"anchor":"Future-Extensibility","text":"Future Extensibility","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The architecture supports:"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Custom storage backends","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Custom themes"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Custom appearances"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Custom view components","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Animation system (planned)"}]}]}],"type":"unorderedList"},{"level":2,"anchor":"Related-Topics","text":"Related Topics","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"View"}]}]},{"content":[{"inlineContent":[{"code":"Theme","type":"codeVoice"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"Appearance","type":"codeVoice"}]}]},{"content":[{"inlineContent":[{"code":"FocusManager","type":"codeVoice"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"FrameBuffer"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"doc:Rendering","type":"text"}]}]},{"content":[{"inlineContent":[{"isActive":true,"type":"reference","identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/StateManagement"}],"type":"paragraph"}]}],"type":"unorderedList"}]}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/Architecture"},"references":{"doc://com.anthropic.tuikit.documentation/documentation/TUIKit/StateManagement":{"kind":"article","title":"State Management","url":"\/documentation\/tuikit\/statemanagement","identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/StateManagement","abstract":[{"type":"text","text":"Learn how to manage application state and data flow in TUIKit."}],"role":"article","type":"topic"},"doc://com.anthropic.tuikit.documentation/documentation/TUIKit":{"kind":"article","title":"TUIKit","url":"\/documentation\/tuikit","identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit","abstract":[],"role":"collection","type":"topic"}}}