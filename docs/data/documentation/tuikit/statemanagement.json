{"hierarchy":{"paths":[["doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit"]]},"metadata":{"role":"article","title":"State Management","roleHeading":"Article"},"kind":"article","identifier":{"url":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit\/StateManagement","interfaceLanguage":"swift"},"primaryContentSections":[{"content":[{"anchor":"Overview","level":2,"text":"Overview","type":"heading"},{"inlineContent":[{"text":"TUIKit provides several mechanisms for managing state:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"inlineContent":[{"code":"@State","type":"codeVoice"}],"type":"strong"},{"text":": Local view state","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"codeVoice","code":"@Environment"}]},{"type":"text","text":": Top-down data flow"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"code":"Binding","type":"codeVoice"}]},{"type":"text","text":": Two-way data binding"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"codeVoice","code":"@AppStorage"}]},{"text":": Persistent application settings","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"codeVoice","code":"@SceneStorage"}]},{"type":"text","text":": Scene-specific state restoration"}],"type":"paragraph"}]}],"type":"unorderedList"},{"anchor":"State-Property-Wrapper","level":2,"text":"@State Property Wrapper","type":"heading"},{"inlineContent":[{"type":"codeVoice","code":"@State"},{"type":"text","text":" stores local state within a view and automatically triggers re-renders when the value changes:"}],"type":"paragraph"},{"syntax":"swift","code":["struct Counter: View {","    @State var count: Int = 0","","    var body: some View {","        VStack(spacing: 1) {","            Text(\"Count: \\(count)\")","                .bold()","","            HStack(spacing: 2) {","                Button(\"Decrement\") { count -= 1 }","                Button(\"Increment\") { count += 1 }","            }","        }","    }","}"],"type":"codeListing"},{"anchor":"Rules-for-State","level":3,"text":"Rules for @State","type":"heading"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Declare as "},{"type":"codeVoice","code":"private"},{"type":"text","text":" to prevent external modification"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Initialize with a default value","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"Use only in views, not in view models","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"State is destroyed when view is removed from hierarchy","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"syntax":"swift","code":["struct InputForm: View {","    @State private var name: String = \"\"","    @State private var age: Int = 0","    @State private var agreed: Bool = false","","    var body: some View {","        VStack(spacing: 1) {","            \/\/ View content","        }","    }","}"],"type":"codeListing"},{"anchor":"Binding","level":2,"text":"Binding","type":"heading"},{"inlineContent":[{"type":"text","text":"A "},{"type":"codeVoice","code":"Binding"},{"type":"text","text":" creates a two-way connection between a view and a state variable:"}],"type":"paragraph"},{"type":"codeListing","code":["struct Parent: View {","    @State var isExpanded: Bool = false","","    var body: some View {","        VStack {","            Child(isExpanded: $isExpanded)","        }","    }","}","","struct Child: View {","    @Binding var isExpanded: Bool","","    var body: some View {","        Button(isExpanded ? \"Collapse\" : \"Expand\") {","            isExpanded.toggle()","        }","    }","}"],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"Use ","type":"text"},{"code":"$","type":"codeVoice"},{"text":" to create a binding to a state property.","type":"text"}]},{"type":"heading","text":"Creating Custom Bindings","level":3,"anchor":"Creating-Custom-Bindings"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Create computed bindings for complex logic:"}]},{"type":"codeListing","code":["struct FilteredList: View {","    @State private var showDetails: Bool = false","","    var detailsBinding: Binding<Bool> {","        Binding(","            get: { showDetails },","            set: { newValue in","                if newValue {","                    print(\"Details opened\")","                }","                showDetails = newValue","            }","        )","    }","","    var body: some View {","        Button(\"Toggle\") {","            detailsBinding.wrappedValue.toggle()","        }","    }","}"],"syntax":"swift"},{"type":"heading","text":"@Environment and Environment Keys","level":2,"anchor":"Environment-and-Environment-Keys"},{"type":"paragraph","inlineContent":[{"text":"Environment provides top-down data flow to all child views:","type":"text"}]},{"type":"codeListing","code":["struct App: View {","    var body: some View {","        VStack {","            ContentView()","                .environment(\\.theme, customTheme)","        }","    }","}","","struct ContentView: View {","    @Environment(\\.theme) var theme","","    var body: some View {","        Text(\"Using current theme\")","            .foregroundColor(theme.foreground)","    }","}"],"syntax":"swift"},{"type":"heading","text":"Custom Environment Keys","level":3,"anchor":"Custom-Environment-Keys"},{"type":"paragraph","inlineContent":[{"text":"Define custom environment values:","type":"text"}]},{"syntax":"swift","code":["struct UserPreferencesKey: EnvironmentKey {","    static let defaultValue = UserPreferences()","}","","extension EnvironmentValues {","    var userPreferences: UserPreferences {","        get { self[UserPreferencesKey.self] }","        set { self[UserPreferencesKey.self] = newValue }","    }","}","","\/\/ Usage","struct App: View {","    var body: some View {","        VStack {","            ContentView()","                .environment(\\.userPreferences, UserPreferences(language: \"de\"))","        }","    }","}","","struct ContentView: View {","    @Environment(\\.userPreferences) var prefs","","    var body: some View {","        Text(\"Language: \\(prefs.language)\")","    }","}"],"type":"codeListing"},{"anchor":"AppStorage","level":2,"text":"@AppStorage","type":"heading"},{"inlineContent":[{"code":"@AppStorage","type":"codeVoice"},{"type":"text","text":" persists values to storage (UserDefaults on macOS, JSON file on Linux):"}],"type":"paragraph"},{"syntax":"swift","code":["struct App: View {","    @AppStorage(\"theme\") var selectedTheme: String = \"green\"","    @AppStorage(\"fontSize\") var fontSize: Int = 12","","    var body: some View {","        VStack {","            Text(\"Current theme: \\(selectedTheme)\")","            \/\/ Settings UI","        }","    }","}"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"Changes to "},{"type":"codeVoice","code":"@AppStorage"},{"type":"text","text":" variables are automatically saved and restored across app launches."}],"type":"paragraph"},{"anchor":"SceneStorage","level":2,"text":"@SceneStorage","type":"heading"},{"inlineContent":[{"type":"codeVoice","code":"@SceneStorage"},{"text":" preserves state for the current scene:","type":"text"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["struct MyScene: Scene {","    @SceneStorage(\"selectedTab\") var selectedTab: String = \"home\"","    @SceneStorage(\"scrollPosition\") var scrollPosition: Int = 0","","    var body: some Scene {","        WindowGroup {","            VStack {","                if selectedTab == \"home\" {","                    HomeView()","                }","            }","        }","    }","}"]},{"anchor":"Data-Flow-Pattern","type":"heading","level":2,"text":"Data Flow Pattern"},{"anchor":"Recommended-Pattern","type":"heading","level":3,"text":"Recommended Pattern"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Local state"}]},{"text":": Use ","type":"text"},{"type":"codeVoice","code":"@State"},{"text":" for temporary UI state","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Shared state","type":"text"}]},{"type":"text","text":": Use "},{"code":"@Environment","type":"codeVoice"},{"type":"text","text":" to pass to child views"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Persistent state"}],"type":"strong"},{"type":"text","text":": Use "},{"code":"@AppStorage","type":"codeVoice"},{"type":"text","text":" for settings"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Child updates"}],"type":"strong"},{"text":": Use ","type":"text"},{"type":"codeVoice","code":"@Binding"},{"text":" to let children modify parent state","type":"text"}],"type":"paragraph"}]}],"type":"orderedList"},{"syntax":"swift","type":"codeListing","code":["@main","struct MyApp: App {","    \/\/ Persistent settings","    @AppStorage(\"theme\") var theme: String = \"green\"","","    var body: some Scene {","        WindowGroup {","            ContentView()","                .environment(\\.theme, themeForString(theme))","        }","    }","}","","struct ContentView: View {","    @Environment(\\.theme) var theme","    @State private var showMenu: Bool = false","","    var body: some View {","        VStack {","            if showMenu {","                MenuView(showing: $showMenu)","            }","        }","    }","}"]},{"anchor":"Related-Topics","type":"heading","level":2,"text":"Related Topics"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"State"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Binding"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"@Environment"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"@AppStorage"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"@SceneStorage"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"EnvironmentKey"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"EnvironmentValues","type":"codeVoice"}]}]}],"type":"unorderedList"}],"kind":"content"}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"abstract":[{"type":"text","text":"Learn how to manage application state and data flow in TUIKit."}],"references":{"doc://com.anthropic.tuikit.documentation/documentation/TUIKit":{"title":"TUIKit","identifier":"doc:\/\/com.anthropic.tuikit.documentation\/documentation\/TUIKit","type":"topic","abstract":[],"kind":"article","role":"collection","url":"\/documentation\/tuikit"}}}